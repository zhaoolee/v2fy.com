---
title: Windowsï¼ŒmacOSï¼ŒLinuxæ¢è¡Œæ ‡è¯†çš„å‰ä¸–ä»Šç”Ÿï¼Œå¦‚ä½•å¤„ç†æ–‡æœ¬æ–‡ä»¶è¡Œå°¾çš„^M / The Past and Present of Line Break Symbols in Windows, macOS, Linux, How to Deal with ^M at the End of Text Files
categories:
- æå®¢å®ç”¨æŠ€å·§ / Geek Practical Skills
---

æˆ‘ä»¬åœ¨Windowsåˆ›å»ºæ–‡æœ¬æ–‡ä»¶ï¼Œé»˜è®¤ä½¿ç”¨çš„æ¢è¡Œæ ‡è¯†ä¸º`CRLF`

ğŸŒˆWhen we create a text file in Windows, the default line break symbol is `CRLF`.


![image-20230924120415808](https://cdn.fangyuanxiaozhan.com/assets/16955282573144HN2TYxW.png)

è¿™ç§CRLFæ–‡ä»¶åœ¨Linuxç³»ç»Ÿä¸­æ‰“å¼€ï¼Œåˆ™ä¼šåœ¨æ¢è¡Œçš„ä½ç½®æ˜¾ç¤º`^M`

ğŸŒˆWhen this CRLF file is opened in the Linux system, `^M` will be displayed at the line break.

![image-20230924120459064](https://cdn.fangyuanxiaozhan.com/assets/1695528299944rN20CR3G.png)



##  ä¸ºä»€ä¹ˆä¼šå‡ºç°`^M` / Why Does `^M` Appear?

Windowsæ¢è¡Œä½¿ç”¨çš„`CRLF`æ ‡å‡†ï¼Œ`CRLF`æ¨¡ä»¿äº†è€å¼æ‰“å­—æœºï¼Œåœ¨è€å¼æ‰“å­—æœºä¸­ï¼Œ**Carriage Return**ï¼ˆ`\r`ï¼Œå›è½¦ï¼‰çš„åŠŸèƒ½æ˜¯å°†æ‰“å°å¤´ç§»å›è¡Œé¦–ï¼Œè€Œ **Line Feed**ï¼ˆ`\n`ï¼Œæ¢è¡Œï¼‰çš„åŠŸèƒ½æ˜¯å°†çº¸å¼ å‘ä¸Šç§»åŠ¨ä¸€è¡Œã€‚å› æ­¤ï¼Œä¸ºäº†å¼€å§‹æ–°çš„ä¸€è¡Œï¼Œéœ€è¦å…ˆæ‰§è¡Œå›è½¦æ“ä½œï¼Œç„¶åæ‰§è¡Œæ¢è¡Œæ“ä½œã€‚

ğŸŒˆWindows uses the `CRLF` standard for line breaks, which imitates old typewriters. In old typewriters, the function of **Carriage Return** (`\r`, return) is to move the print head back to the beginning of the line, while **Line Feed** (`\n`, line break) moves the paper up one line. Therefore, to start a new line, you need to first perform a return operation and then a line break operation.

![IMG_3526-2](https://cdn.fangyuanxiaozhan.com/assets/1695529463324w1ATxdtT.jpeg)



è€ŒLinuxç³»ç»Ÿåˆ™ç®€åŒ–äº†æ“ä½œï¼Œä½¿ç”¨å•ç‹¬çš„ `LF` ä½œä¸ºè¡Œå°¾æ ‡è®°ï¼Œå¤šå‡ºæ¥çš„`CR` åˆ™è¢«æ˜¾ç¤ºä¸º`^M`  ï¼ˆ`CR`åœ¨ ASCII è¡¨ä¸­çš„å€¼æ˜¯ 13, `^` æ˜¯æ§åˆ¶å­—ç¬¦çš„å‰ç¼€ï¼Œ`M` æ˜¯ ASCII è¡¨ä¸­ç¬¬ 13 ä¸ªå­—ç¬¦ï¼‰

ğŸŒˆOn the other hand, the Linux system has simplified this process by using a single `LF` as the end-of-line marker. The extra `CR` is displayed as `^M` (`CR` has a value of 13 in the ASCII table, `^` is the prefix for control characters, and `M` is the 13th character in the ASCII table).

## æ— ç”¨çš„çŸ¥è¯† / Useless Knowledge

æœ€éªšçš„æ˜¯ï¼ŒMac OS Xä»¥å‰çš„ç‰ˆæœ¬(ä¹Ÿå°±æ˜¯2001å¹´ä¹‹å‰çš„ç‰ˆæœ¬)é‡‡ç”¨`CR`ä½œä¸ºæ¢è¡Œç¬¦ï¼Œå’ŒWindowsçš„`CRLF`ä¸Linuxçš„`LF`éƒ½ä¸ä¸€æ ·ï¼Œå¤æ—©æ—¶æœŸçš„ç¨‹åºå‘˜ä»¬è·¨æ“ä½œç³»ç»Ÿå†™è„šæœ¬çœŸçš„å¤‡å—æŠ˜ç£¨ã€‚

ğŸŒˆWhat's interesting is that versions of Mac OS X prior to 2001 used `CR` as the line break symbol, which is different from Windows' `CRLF` and Linux's `LF`. Programmers from the old days really suffered when writing scripts across different operating systems.

Mac OS Xä»¥åŠä¹‹åçš„ç‰ˆæœ¬ï¼ˆ`Mac OS X`å…ˆåæ”¹åä¸º,  `OS X` ï¼Œ `macOS`ï¼‰ï¼Œæœ€åé‡‡ç”¨äº†`LF`çš„æ¢è¡Œæ ‡å‡†ï¼Œç®—æ˜¯å’ŒLinuxè¾¾æˆäº†ä¸€è‡´ï¼Œè¿™ä¹Ÿæ˜¯ç¨‹åºå‘˜åçˆ±macOSç³»ç»Ÿçš„åŸå› ï¼Œç¨‹åºå‘˜å†™çš„ç¨‹åºä¼šæ”¾åˆ°æœåŠ¡å™¨è¿è¡Œï¼Œè€ŒæœåŠ¡å™¨å¤§å¤šè¿è¡ŒLinux

ğŸŒˆMac OS X and its subsequent versions (which were renamed `OS X` and then `macOS`) eventually adopted the `LF` line break standard, which is consistent with Linux. This is why programmers prefer the macOS system, as the programs they write will be run on servers, and most servers run Linux.

## å¦‚ä½•æ¶ˆé™¤^Mï¼Ÿ / How to Eliminate ^M?

æ–¹æ³•1: ä½¿ç”¨VScodeæ¶ˆé™¤ï¼ˆé€‚åˆå°‘é‡æ–‡ä»¶ï¼‰

ğŸŒˆMethod 1: Use VScode to eliminate (suitable for a small number of files)

åœ¨Windowsä¸­ï¼Œ`^M` æ˜¯æ¢è¡Œçš„ä¸€éƒ¨åˆ†ï¼Œä¸éœ€è¦æ¶ˆé™¤ï¼›å¦‚æœä½ ä½¿ç”¨ä¸“ä¸šä»£ç ç¼–è¾‘å™¨VScodeï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šæ¢è¡Œæ–¹å¼ï¼Œå¦‚æœä½ çš„æ–‡æœ¬æ–‡ä»¶å·²ç»é‡‡ç”¨äº† `CRLF` ç¼–å†™ï¼Œä¹Ÿå¯ä»¥é€šè¿‡VScodeç›´æ¥è½¬æ¢ä¸º`LF`æ¢è¡Œã€‚

ğŸŒˆIn Windows, `^M` is part of the line break and does not need to be eliminated. If you use a professional code editor like VScode, you can also manually specify the line break method. If your text file has already been written using `CRLF`, you can also convert it directly to `LF` line breaks through VScode.

![image-20230924124314144](https://cdn.fangyuanxiaozhan.com/assets/1695530595575TGdiNx4m.png)



æ–¹æ³•2: ä½¿ç”¨`dos2unix`è½¬æ¢ï¼ˆé€‚åˆå¤§é‡æ–‡ä»¶è½¬æ¢ï¼‰

ğŸŒˆMethod 2: Use `dos2unix` for conversion (suitable for a large number of file conversions)

```
# å®‰è£…dos2unix / Install dos2unix
sudo apt install dos2unix -y 
```

ä¿ç•™æ—§æ–‡ä»¶ï¼Œè½¬æ¢å•ä¸ªæ–‡ä»¶

ğŸŒˆKeep the old file and convert a single file

```
# ä¿ç•™åŸæ–‡ä»¶è½¬æ¢ dos2unix -n oldfile newfile / Keep the original file for conversion dos2unix -n oldfile newfile
dos2unix -n  newline-character-æ¢è¡Œç¬¦.txt newline-character-æ¢è¡Œç¬¦-for-unix.txt
```

![image-20230924140437651](https://cdn.fangyuanxiaozhan.com/assets/1695535481885DaycQ2it.png)



![image-20230924140700525](https://cdn.fangyuanxiaozhan.com/assets/1695535621361TJhbmBMw.png)

ä¸ä¿ç•™æ—§æ–‡ä»¶ï¼Œç›´æ¥è½¬æ¢å•ä¸ªæ–‡ä»¶

ğŸŒˆDo not keep the old file, directly convert a single file

```
# å•ä¸ªæ–‡ä»¶ / Single file
dos2unix file
```

ä¸ä¿ç•™æ—§æ–‡ä»¶, æ‰¹é‡è½¬æ¢æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶ ï¼ˆè°¨æ…èµ·è§ï¼Œè¯·æå‰å¤åˆ¶æ–‡ä»¶å¤¹åšå¥½å¤‡ä»½ï¼‰

ğŸŒˆDo not keep old files, batch convert files in the folder (to be cautious, please copy the folder in advance for backup)

```
# è½¬æ¢æŸæ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰æ–‡ä»¶ / Convert all files in a folder
find /path/to/your/directory -type f -exec dos2unix {} \;
```

![image-20230924141020252](https://cdn.fangyuanxiaozhan.com/assets/1695535821104yfsD7hkS.png)

æ‰¹é‡è½¬æ¢æˆåŠŸï¼

ğŸŒˆBatch conversion successful!

## å°ç»“ / Summary

Windows æ˜¯æ°‘ç”¨é¢†åŸŸå¸‚åœºå æœ‰ç‡æœ€é«˜çš„æ“ä½œç³»ç»Ÿï¼Œä½†åœ¨Windowsä¸Šåšç¨‹åºå¼€å‘ï¼Œç¡®å®ä¼šé‡åˆ°`CRLF`è¿™ç±»ç‹¬ç‰¹å¥‡å¦™çš„å°é—®é¢˜ï¼Œå¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œç”¨Windowså¯åŠ¨Linuxè™šæ‹Ÿæœºï¼Œåœ¨è™šæ‹Ÿæœºä¸­åšå¼€å‘ï¼Œä¹Ÿè®¸æ˜¯çœäº‹çš„å¼€å‘ç­–ç•¥ã€‚

ğŸŒˆWindows is the operating system with the highest market share in the consumer field, but when doing program development on Windows, you will indeed encounter unique and interesting little problems like `CRLF`. For developers, using Windows to launch a Linux virtual machine and doing development in the virtual machine may be a convenient development strategy.
